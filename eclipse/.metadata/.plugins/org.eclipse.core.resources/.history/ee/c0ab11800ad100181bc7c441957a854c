package net.theexceptionist.coherentvillages.main.events;

import java.util.Random;

import net.minecraft.util.math.BlockPos;
import net.minecraft.world.World;
import net.theexceptionist.coherentvillages.main.entity.EntityHumanVillager;
import net.theexceptionist.coherentvillages.main.entity.attributes.AttributeRace;
import net.theexceptionist.coherentvillages.worldgen.villages.WorldGenVillage;

public class EventBanditSkirmish extends Event {
	public EventBanditSkirmish(Random rand, boolean startInDay, int chance, int range, int raceID) {
		super(rand, startInDay, chance, range, raceID);
	}

	@Override
	public void execute() {
		int count = this.rand.nextInt(4) + 2;
		if(this.player != null)
		{
			double x = this.player.posX + this.rand.nextInt(range * 2) - range;
			double z = this.player.posZ + this.rand.nextInt(range * 2) - range;
			double y = this.player.world.getTopSolidOrLiquidBlock(new BlockPos(x, 80, z)).getY();
			BlockPos spawn = new BlockPos(x, y, z);
			World worldIn = this.player.world;
			
			for(int i = 0; i < count; i++)
			{
				EntityHumanVillager soldier = new EntityHumanVillager();
			
				EntityHumanVillager bandit = new EntityHumanVillager(worldIn, WorldGenVillage.NORD_ID, AttributeRace.getFromIDRace(WorldGenVillage.NORD_ID).getRandomBandit(worldIn), EntityHumanVillager.getRandomGender(worldIn), false);                            
            	bandit.setLocationAndAngles((double)x + 0.5D, (double)y, (double)z + 0.5D, 0.0F, 0.0F);
                //entityHumanVillager.setProfession(this.chooseForgeProfession(i, entityHumanVillager.getProfessionForge()));
                //entityHumanVillager.finalizeMobSpawn(worldIn.getDifficultyForLocation(new BlockPos(entityHumanVillager)), (IEntityLivingData)null, false);
                worldIn.spawnEntity(bandit);
                
			}
			
			this.spawned = true;
		}
		else 
		{
			return;
		}
	}

	@Override
	public void reset() {
		if(this.player != null && this.player.world.isDaytime() != startInDay)
		{
			this.spawned = false;
		}
	}

}
